'''
This code will carry out an automated penetration Testing

'''
import nmap
import requests



# Nmap initialization
nm = nmap.PortScanner()

def scanning_host(host):
    print(f"Scanning {host} for open ports...")
    nm.scan(host, '1-1024')
    for host in nm.all_hosts():
        print(f"Host: {host} ({nm[host].hostname()})")
        print(f"State: {nm[host].state()}")
        for p in nm[host].all_protocols():
            print(f"Protocol: {p}")
            lport = nm[host][p].keys()
            for port in lport:
                print(f"Port: {port}\tState: {nm[host][p][port]['state']}")
    
    
def testing_web_vulnerability(url):
    print(f"Testing {url} for common web vulnerabilities...")
    
    try:
        # sql injection checking 
        sql_injection_url = url + "' OR '1'='1"
        response = requests.get(sql_injection_url)
        if "error" in response.text or "mysql" in response.text.lower():
            print(f"Potential SQL Injection vulnerability found at {url}")
        else:
            print("No SQL Injection vulnerabilities detected.")
         
    except Exception as e:
        print(f"Error testing the {url}: {e}")
        
        
if __name__ == "__main__":
    # Scanning a host
    host = '127.0.0.1'  # Replace with your target IP or hostname
    url = 'Amazon.com'  # Replace with your target URL

    scanning_host(host)
    testing_web_vulnerability(url)
        
    
    